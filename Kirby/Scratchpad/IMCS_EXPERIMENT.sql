/*******************************************************************************
 * IMCS OFF (BASELINE)
 ******************************************************************************/



ALTER TABLE CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1 INMEMORY NO MEMCOMPRESS;
ALTER TABLE CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1 INMEMORY NO MEMCOMPRESS;
ALTER TABLE CAPSTONE_DEMO.LEAD_LAG_V1 INMEMORY NO MEMCOMPRESS;
ALTER TABLE CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1 INMEMORY NO MEMCOMPRESS;
ALTER SESSION SET CONTAINER = CDB$ROOT;
ALTER SYSTEM SET DB_BIG_TABLE_CACHE_PERCENT_TARGET = 0;
ALTER SYSTEM SET INMEMORY_SIZE=0G SCOPE=SPFILE;
ALTER PLUGGABLE DATABASE DBCAP CLOSE IMMEDIATE;
ALTER PLUGGABLE DATABASE DBCAP OPEN;
ALTER SESSION SET CONTAINER = DBCAP;
EXECUTE CAPSTONE_DEMO.RESOURCE_MONITOR.PARAMETERS_HISTORY_INSERT;

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_MODULE(MODULE_NAME => 'IMCS_NO_COMPRESS_EXPERIMENT',ACTION_NAME => 'RESOURCE_MONITORING'); 
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'SINGLE_TABLE_ANALYTICS_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'PARENT_CHILD_ANALYTICS_V1');
END;
/
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'LEAD_LAG_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'FILTER_PARENT_CHILD_JOIN_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 3



/*******************************************************************************
 * IMCS COMPRESSION (LEAST)
 ******************************************************************************/



ALTER TABLE CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1 INMEMORY MEMCOMPRESS FOR DML;
ALTER TABLE CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1 INMEMORY MEMCOMPRESS FOR DML;
ALTER TABLE CAPSTONE_DEMO.LEAD_LAG_V1 INMEMORY MEMCOMPRESS FOR DML;
ALTER TABLE CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1 MEMCOMPRESS FOR DML;
ALTER SESSION SET CONTAINER = CDB$ROOT;
ALTER SYSTEM SET DB_BIG_TABLE_CACHE_PERCENT_TARGET = 0;
ALTER SYSTEM SET INMEMORY_SIZE=64G SCOPE=SPFILE;
ALTER PLUGGABLE DATABASE DBCAP CLOSE IMMEDIATE;
ALTER PLUGGABLE DATABASE DBCAP OPEN;
ALTER SESSION SET CONTAINER = DBCAP;
EXECUTE CAPSTONE_DEMO.RESOURCE_MONITOR.PARAMETERS_HISTORY_INSERT;

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_MODULE(MODULE_NAME => 'IMCS_EXPERIMENT',ACTION_NAME => 'RESOURCE_MONITORING'); 
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'SINGLE_TABLE_ANALYTICS_V1');
END;
/

-- Run query once (which spawns initial IMCS background workers), wait 240 seconds
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Warmup
BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 240);
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'PARENT_CHILD_ANALYTICS_V1');
END;
/
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'LEAD_LAG_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'FILTER_PARENT_CHILD_JOIN_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 3



/*******************************************************************************
 * IMCS COMPRESSION (LOW)
 ******************************************************************************/



ALTER TABLE CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1 INMEMORY MEMCOMPRESS FOR QUERY LOW;
ALTER TABLE CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1 INMEMORY MEMCOMPRESS FOR QUERY LOW;
ALTER TABLE CAPSTONE_DEMO.LEAD_LAG_V1 INMEMORY MEMCOMPRESS FOR QUERY LOW;
ALTER TABLE CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1 INMEMORY MEMCOMPRESS FOR QUERY LOW;
ALTER SESSION SET CONTAINER = CDB$ROOT;
ALTER SYSTEM SET DB_BIG_TABLE_CACHE_PERCENT_TARGET = 0;
ALTER SYSTEM SET INMEMORY_SIZE=64G SCOPE=SPFILE;
ALTER PLUGGABLE DATABASE DBCAP CLOSE IMMEDIATE;
ALTER PLUGGABLE DATABASE DBCAP OPEN;
ALTER SESSION SET CONTAINER = DBCAP;
EXECUTE CAPSTONE_DEMO.RESOURCE_MONITOR.PARAMETERS_HISTORY_INSERT;

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_MODULE(MODULE_NAME => 'IMCS_QUERY_LOW_COMPRESS_EXPERIMENT',ACTION_NAME => 'RESOURCE_MONITORING'); 
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'SINGLE_TABLE_ANALYTICS_V1');
END;
/

-- Run query once (which spawns initial IMCS background workers), wait 240 seconds
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Warmup
BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 240);
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'PARENT_CHILD_ANALYTICS_V1');
END;
/
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'LEAD_LAG_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'FILTER_PARENT_CHILD_JOIN_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 3



/*******************************************************************************
 * IMCS COMPRESSION (MED LOW)
 ******************************************************************************/



ALTER TABLE CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1 INMEMORY MEMCOMPRESS FOR QUERY HIGH;
ALTER TABLE CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1 INMEMORY MEMCOMPRESS FOR QUERY HIGH;
ALTER TABLE CAPSTONE_DEMO.LEAD_LAG_V1 INMEMORY MEMCOMPRESS FOR QUERY HIGH;
ALTER TABLE CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1 INMEMORY MEMCOMPRESS FOR QUERY HIGH;
ALTER SESSION SET CONTAINER = CDB$ROOT;
ALTER SYSTEM SET DB_BIG_TABLE_CACHE_PERCENT_TARGET = 0;
ALTER SYSTEM SET INMEMORY_SIZE=64G SCOPE=SPFILE;
ALTER PLUGGABLE DATABASE DBCAP CLOSE IMMEDIATE;
ALTER PLUGGABLE DATABASE DBCAP OPEN;
ALTER SESSION SET CONTAINER = DBCAP;
EXECUTE CAPSTONE_DEMO.RESOURCE_MONITOR.PARAMETERS_HISTORY_INSERT;

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_MODULE(MODULE_NAME => 'IMCS_QUERY_HIGH_COMPRESS_EXPERIMENT',ACTION_NAME => 'RESOURCE_MONITORING'); 
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'SINGLE_TABLE_ANALYTICS_V1');
END;
/

-- Run query once (which spawns initial IMCS background workers), wait 240 seconds
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Warmup
BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 240);
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'PARENT_CHILD_ANALYTICS_V1');
END;
/
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'LEAD_LAG_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'FILTER_PARENT_CHILD_JOIN_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 3



/*******************************************************************************
 * IMCS COMPRESSION (MED)
 ******************************************************************************/



ALTER TABLE CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1 INMEMORY MEMCOMPRESS FOR CAPACITY LOW;
ALTER TABLE CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1 INMEMORY MEMCOMPRESS FOR CAPACITY LOW;
ALTER TABLE CAPSTONE_DEMO.LEAD_LAG_V1 INMEMORY MEMCOMPRESS FOR CAPACITY LOW;
ALTER TABLE CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1 INMEMORY MEMCOMPRESS FOR CAPACITY LOW;
ALTER SESSION SET CONTAINER = CDB$ROOT;
ALTER SYSTEM SET DB_BIG_TABLE_CACHE_PERCENT_TARGET = 0;
ALTER SYSTEM SET INMEMORY_SIZE=64G SCOPE=SPFILE;
ALTER PLUGGABLE DATABASE DBCAP CLOSE IMMEDIATE;
ALTER PLUGGABLE DATABASE DBCAP OPEN;
ALTER SESSION SET CONTAINER = DBCAP;
EXECUTE CAPSTONE_DEMO.RESOURCE_MONITOR.PARAMETERS_HISTORY_INSERT;

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_MODULE(MODULE_NAME => 'IMCS_CAPACITY_LOW_COMPRESS_EXPERIMENT',ACTION_NAME => 'RESOURCE_MONITORING'); 
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'SINGLE_TABLE_ANALYTICS_V1');
END;
/

-- Run query once (which spawns initial IMCS background workers), wait 240 seconds
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Warmup
BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 240);
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'PARENT_CHILD_ANALYTICS_V1');
END;
/
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'LEAD_LAG_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'FILTER_PARENT_CHILD_JOIN_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 3



/*******************************************************************************
 * IMCS COMPRESSION (HIGH)
 ******************************************************************************/



ALTER TABLE CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1 INMEMORY MEMCOMPRESS FOR CAPACITY HIGH;
ALTER TABLE CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1 INMEMORY MEMCOMPRESS FOR CAPACITY HIGH;
ALTER TABLE CAPSTONE_DEMO.LEAD_LAG_V1 INMEMORY MEMCOMPRESS FOR CAPACITY HIGH;
ALTER TABLE CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1 INMEMORY MEMCOMPRESS FOR CAPACITY HIGH;
ALTER SESSION SET CONTAINER = CDB$ROOT;
ALTER SYSTEM SET DB_BIG_TABLE_CACHE_PERCENT_TARGET = 0;
ALTER SYSTEM SET INMEMORY_SIZE=64G SCOPE=SPFILE;
ALTER PLUGGABLE DATABASE DBCAP CLOSE IMMEDIATE;
ALTER PLUGGABLE DATABASE DBCAP OPEN;
ALTER SESSION SET CONTAINER = DBCAP;
EXECUTE CAPSTONE_DEMO.RESOURCE_MONITOR.PARAMETERS_HISTORY_INSERT;

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_MODULE(MODULE_NAME => 'IMCS_CAPACITY_HIGH_COMPRESS_EXPERIMENT',ACTION_NAME => 'RESOURCE_MONITORING'); 
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'SINGLE_TABLE_ANALYTICS_V1');
END;
/

-- Run query once (which spawns initial IMCS background workers), wait 240 seconds
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Warmup
BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 240);
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'PARENT_CHILD_ANALYTICS_V1');
END;
/
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'LEAD_LAG_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; --Run 3

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'FILTER_PARENT_CHILD_JOIN_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 1
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 2
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; --Run 3