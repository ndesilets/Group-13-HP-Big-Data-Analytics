alter session set container = dbcap;

EXECUTE CAPSTONE_DEMO.RESOURCE_MONITOR.PARAMETERS_HISTORY_INSERT;

@wait_imcs_fill.sql

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_MODULE(MODULE_NAME => 'IMCS_EXPERIMENT',ACTION_NAME => 'RESOURCE_MONITORING'); 
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'SINGLE_TABLE_ANALYTICS_V1');
END;
/

-- Run query once (which spawns initial IMCS background workers), wait 10 mins
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; --Warmup
BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 600);
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; 
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; 
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.SINGLE_TABLE_ANALYTICS_V1; 

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'PARENT_CHILD_ANALYTICS_V1');
END;
/
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; 
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; 
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.PARENT_CHILD_ANALYTICS_V1; 

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'LEAD_LAG_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; 
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; 
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.LEAD_LAG_V1; 

BEGIN
  DBMS_LOCK.SLEEP(SECONDS => 30);
  DBMS_APPLICATION_INFO.SET_CLIENT_INFO(CLIENT_INFO => 'FILTER_PARENT_CHILD_JOIN_V1');
END;
/

SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; 
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; 
SELECT /*+ PARALLEL(16) */ * FROM CAPSTONE_DEMO.FILTER_PARENT_CHILD_JOIN_V1; 
